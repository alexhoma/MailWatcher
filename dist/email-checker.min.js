"use strict";function addEmail(){var a=document.querySelector("#suggestion a"),b=document.getElementById("email"),c=document.getElementById("suggestion");b.value=a.text,c.remove()}var EmailChecker=function(a,b){this.NAME="EmailChecker",this.VERSION="1.0.3",this.emailId=a,this.settings=this.updateDefaults(b)};EmailChecker.prototype={constructor:EmailChecker,whitelist:["gmail","hotmail","yahoo","outlook","derecho"],blacklist:["gemail","gmil","gmal","emai","gmai","hotmal","hormal","hormail","homail","hitmail","hotamail","yaho","yahho","yahooo","yaaho","outlok","oultook","utlook","outoolk"],validTLDs:["cat","es","com","net","org","io","barcelona","design","online","tech"],defaults:{mode:"hard",locale:"en-En"},check:function(){var a,b=document.getElementById(this.emailId),c=b.value,d=document.getElementById("suggestion");null!==d&&d.remove();var e=this.splitEmail(c),f=this.validationApproach(e.domain);if(f||(a=this.repairEmail(e.domain)),"undefined"==typeof a)return b.value=e.user+"@"+e.domain+"."+e.tld;var g=e.user+"@"+a+"."+e.tld;if("hard"===this.defaults.mode)return b.value=g;if("soft"===this.defaults.mode){var h=this.suggest(g);return b.parentNode.insertBefore(h,b.nextSibling)}},splitEmail:function(a){var b,c,d,e=a.indexOf("@");return e>-1&&(d=a.split("@")[0],d=this.sanitize(d),b=a.split("@")[1],b=b.split(".")[0],b=this.sanitize(b),c=a.substr(e,a.length),c=c.split(".")[1],c=this.sanitize(c)),{user:d,domain:b,tld:c}},validationApproach:function(a){for(var b,c,d=!1,e=0;e<this.whitelist.length;e++)if(c=this.levenshtein(this.whitelist[e],a),0==c){b=!0;break}if("undefined"==typeof b)for(e=0;e<this.blacklist.length;e++)if(this.blacklist[e]==a){b=!1,d=!0;break}if("undefined"==typeof b&&a.length>5){var f;for(e=0;e<this.whitelist.length;e++)if(f=Math.round(this.whitelist[e].length-a.length),f>=-1&&f<=1&&(c=this.levenshtein(this.whitelist[e],a),c>=1&&c<=2)){b=!1;break}}return"undefined"==typeof b?(console.log("The email is not on your valid emails list. But it is very likely to be correct."),b=!0):b},repairEmail:function(a){for(var b,c,d=[],e=0;e<this.whitelist.length;e++)c=this.levenshtein(this.whitelist[e],a),c>=1&&c<=2&&d.push(this.whitelist[e]);if(0!=!d.length)throw new Error("Unknown error: no matches for this email.");return 1==d.length?b=d[0]:console.log("Hay más de un email válido que coincide con la corrección. Por tanto no lo vamos a corregir."),b},levenshtein:function(a,b){var c=[],d=a.length,e=b.length;if(0==d)return e;if(0==e)return d;for(var f=d;f>=0;f--)c[f]=[];for(var f=d;f>=0;f--)c[f][0]=f;for(var g=e;g>=0;g--)c[0][g]=g;for(var f=1;f<=d;f++)for(var h=a.charAt(f-1),g=1;g<=e;g++){if(f==g&&c[f][g]>4)return d;var i=b.charAt(g-1),j=h==i?0:1,k=c[f-1][g]+1,l=c[f][g-1]+1,m=c[f-1][g-1]+j;l<k&&(k=l),m<k&&(k=m),c[f][g]=k,f>1&&g>1&&h==b.charAt(g-2)&&a.charAt(f-2)==i&&(c[f][g]=Math.min(c[f][g],c[f-2][g-2]+j))}return c[d][e]},sanitize:function(a){var b;return b=a.trim(),b=b.replace(" ",""),b=b.toLowerCase()},suggest:function(a){var b=document.createElement("div");return b.setAttribute("id","suggestion"),b.innerHTML='Did you mean <a href="#" onclick="addEmail()">'+a+"</a>?",b},updateDefaults:function(a){if("undefined"!=typeof a){if("object"!=typeof a)throw new Error("Email custom settings must be an object: "+a);Object.assign(this.defaults,a)}}};